# Development Docker Compose configuration
# Based on Documenso-Main best practices
# Usage: docker-compose -f docker-compose.dev.yml up

name: signtusk-development

services:
  database:
    image: postgres:16-alpine
    container_name: signtusk-database
    environment:
      - POSTGRES_USER=signtusk
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=signtusk
    ports:
      - 54320:5432
    volumes:
      - dev_database:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U signtusk"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - dev-network

  redis:
    image: redis:7-alpine
    container_name: signtusk-redis
    ports:
      - 6379:6379
    volumes:
      - dev_redis:/data
    command: redis-server --appendonly yes
    networks:
      - dev-network

  mailhog:
    image: mailhog/mailhog
    container_name: signtusk-mailhog
    ports:
      - 1025:1025 # SMTP server
      - 8025:8025 # Web UI
    networks:
      - dev-network

  minio:
    image: minio/minio
    container_name: signtusk-minio
    ports:
      - 9000:9000 # API
      - 9001:9001 # Console
    environment:
      MINIO_ROOT_USER: signtusk
      MINIO_ROOT_PASSWORD: password
    volumes:
      - minio:/data
    command: server /data --console-address ":9001"
    networks:
      - dev-network

  adminer:
    image: adminer
    container_name: signtusk-adminer
    ports:
      - 8080:8080
    environment:
      ADMINER_DEFAULT_SERVER: database
    depends_on:
      - database
    networks:
      - dev-network

  redis-commander:
    image: rediscommander/redis-commander:latest
    container_name: signtusk-redis-commander
    environment:
      - REDIS_HOSTS=local:redis:6379
    ports:
      - 8081:8081
    depends_on:
      - redis
    networks:
      - dev-network

volumes:
  dev_database:
  dev_redis:
  minio:

networks:
  dev-network:
    driver: bridge
